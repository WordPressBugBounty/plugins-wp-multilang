jQuery(document).ready(function(e){e(document).on("click","#wpm-validate-openai-key",function(a){a.preventDefault();let o=e("#wpm-openai-secretkey").val(),i=o.trim();if(0===i.length){e("#wpm-secret-key-error").show();return}provider="openai",e("#wpm-secret-key-error").hide(),e("#wpm-prompt-error").hide(),e(".wpm-openai-api-success-note").hide(),e(".wpm-openai-api-error-note").hide(),e(".wpm-openai-provider-note").hide(),e(this).addClass("updating-message"),e.ajax({url:ajaxurl,type:"POST",data:{action:"wpm_validate_secret_key",provider:provider,secret_key:i,security:wpm_openai_params.wpmpro_openai_nonce},success:function(a){if(e("#wpm-validate-openai-key").removeClass("updating-message"),a.success){let o=a.data.models,i="";e.each(o,function(e,a){i+=`<option value="${a}">${a}</option>`}),e("#wpm-hide-openai-models-wrapper").show(),e("#wpm-openai-models").html(i),e(".wpm-openai-api-success-note").show(),e(".wpm-openai-api-success-note").text(a.data.message)}else a.data&&a.data.message&&(e(".wpm-openai-api-error-note").show(),e(".wpm-openai-api-error-note").text(a.data.message))}})}),e(document).on("click","#wpm-save-openai-settings",function(a){a.preventDefault(),e("#wpm-secret-key-error").hide(),e("#wpm-prompt-error").hide();let o="openai",i="",p=e("#wpm-openai-prompt").val();e("#wpm-openai-models").length>0&&(i=e("#wpm-openai-models").val())&&(i=i.trim());let t="0";e("#wpm_openai_integration").is(":checked")&&(t="1"),console.log("provider ",o),console.log("model ",i);let n=e("#wpm-save-openai-settings");if("openai"===o)e(n).prop("disabled",!0).text("Saving Changes..."),e.ajax({url:ajaxurl,type:"POST",data:{action:"wpm_save_openai_settings",provider:o,model:i,prompt:p,wpm_openai_integration:t,security:wpm_openai_params.wpmpro_openai_nonce},success:function(a){if(!a.success){e("#wpm-prompt-error").text(a.data.message).show(),n.prop("disabled",!1).text("Save Changes");return}window.location.reload(!0)},error:function(){alert("Something went wrong. Please try again."),n.prop("disabled",!1).text("Save Changes")}});else{alert("Please select provider");return}}),e(document).on("click","#wpm_openai_integration",function(a){e(this).is(":checked")?(e(".wpm-openai-children").show(),0===wpm_openai_params.ai_settings.model.length&&e("#wpm-hide-openai-models-wrapper").hide()):e(".wpm-openai-children").hide()})});